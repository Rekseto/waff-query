/*! waff-query v0.5.6 (2016-08-04) | Released under the MIT license */
!function(a,b){var c,d,e,f;if("undefined"!=typeof module){f={};for(c in b)e=b[c],b.hasOwnProperty(c)&&("_"!==c[0]?f[c]=e:f[c.slice(1)]=e);return module.exports=f}if("function"==typeof define&&"object"==typeof define.amd)return define("waff-query",[],function(){f={};for(c in b)e=b[c],b.hasOwnProperty(c)&&("_"!==c[0]?f[c]=e:f[c.slice(1)]=e);return f});this.waff=b,d=[];for(c in b)e=b[c],b.hasOwnProperty(c)?"_"!==c[0]?d.push(this[c]=e):d.push(this.waff[c.slice(1)]=e):d.push(void 0);return d}(null,function(){var a;return a={ps:function(){var a;return a=function(a){var b,c,d,e,f,g,h,i,j,k;if(k=!1,g=!1,j=a||"",e=j.split("."),"."!==j[0]&&(k=e[0]),e.splice(0,1),""===k&&(k=!1),k!==!1&&-1!==k.indexOf("#")&&(c=k.split("#"),k=c[0],g=c[1]),g===!1)for(f=h=0,i=e.length;h<i;f=++h)if(d=e[f],b=d.split("#"),b[1]){g=b[1],e[f]=b[0];break}return{tag:k,id:g,classList:e}}}(),qq:function(){var a;return a=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(b instanceof Array||b instanceof NodeList){for(r=this.ps(a),d=[].slice.call(b),q=[],g=0,j=d.length;g<j;g++)if(f=d[g],o=!0,f instanceof Element){if(o===!0&&r.tag!==!1&&f.tagName.toLowerCase()!==r.tag.toLowerCase()&&(o=!1),o===!0&&r.id!==!1&&f.id!==r.id&&(o=!1),o===!0)for(p=r.classList,h=0,k=p.length;h<k;h++)e=p[h],f.classList.contains(e)||(o=!1);o===!0&&q.push(f)}return q}if(a instanceof Element)return[a];if(b=b instanceof Element?b:document,a instanceof NodeList||a instanceof Array){for(d=[].slice.call(a),c=[],i=0,l=d.length;i<l;i++)a=d[i],a instanceof Element?c.push(a):c.push.apply(c,b.querySelectorAll(a));d=c}else d=[].slice.call(b.querySelectorAll(a));for(q=[],n=0,m=d.length;n<m;n++)f=d[n],f instanceof Element&&q.push(f);return q}}(),q:function(){var a;return a=function(a,b){return this.qq(a,b)[0]||null}}(),e:function(){var a;return a=function(a){var b,c,d,e,f,g;for(g=this.ps(a),c=document.createElement(g.tag||"div"),g.id&&(c.id=g.id),f=g.classList,d=0,e=f.length;d<e;d++)b=f[d],c.classList.add(b);return c}}(),t:function(){var a;return a=function(a){return document.createTextNode(a)}}()},a.selector={parse:a.ps},a.query=a.q,a.q.all=a.qq,a.query.all=a.qq,a.element=a.e,a.text=a.t,a._version="0.5.6",a._get=function(){var b;return b=function(b,c){return null==c&&(c={}),new a._Promise(function(a,d){var e;return e=new XMLHttpRequest,e.open("get",b,!0),e.timeout=c.timeout||2e3,e.on("readystatechange",function(b){var d;if(4===e.readyState&&e.status>=200&&e.status<400)return d=e.responseText,c.json===!0&&(d=JSON.parse(d)),e.res=d,a.call(e,d)}),e.on("error",function(a){return e.res={status:e.status,error:e.statusText},d.call(e,res)}),e.on("timeout",function(a){return e.res={status:e.status,error:e.statusText},d.call(e,res)}),e.overrideMimeType("text/plain"),e.send()})}}(),a._post=function(){var b;return b=function(b,c,d){return null==c&&(c={}),null==d&&(d={}),new a._Promise(function(a,e){var f,g,h,i;if(h=new XMLHttpRequest,h.open("post",b,!0),h.timeout=d.timeout||2e3,h.on("readystatechange",function(b){var c;if(4===h.readyState&&h.status>=200&&h.status<400)return c=h.responseText,d.json===!0&&(c=JSON.parse(c)),h.res=c,a.call(h,c)}),h.on("error",function(a){return h.res={status:h.status,error:h.statusText},e.call(h,res)}),h.on("timeout",function(a){return h.res={status:h.status,error:h.statusText},e.call(h,res)}),null==d.form||d.form===!0){h.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),f=new FormData;for(g in c)i=c[g],c.hasOwnProperty(g)&&f.append(g,i);c=f}return h.send(c)})}}(),a._Promise=function(){var a;return a=function(){function a(a){Event.extend(this),this._then=[],this._catch=[],a(this.resolve(this),this.reject(this))}return a.prototype.then=function(a,b){return this._then.push(a),null!=b&&this._catch.push(b),this},a.prototype.catch=function(a){return this._catch.push(a),this},a.prototype.resolve=function(a){return function(){var b,c,d,e,f;for(a.emit("fulfill"),e=a._then,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.apply(this,arguments));return f}},a.prototype.reject=function(a){return function(){var b,c,d,e,f;for(a.emit("reject"),e=a._then,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.apply(this,arguments));return f}},a}()}(),a._EventEmitter=function(){var b;return b=function(){function b(){this._emitter=a.e()}return b.prototype.on=function(a,b,c){return this._emitter.on.call({emitter:this._emitter,obj:this},a,b,c)},b.prototype.once=function(a,b,c){return this._emitter.once.call({emitter:this._emitter,obj:this},a,b,c)},b.prototype.off=function(a,b,c){return this._emitter.off.call({emitter:this._emitter,obj:this},a,b,c)},b.prototype.emit=function(a,b){return this._emitter.emit.call({emitter:this._emitter,obj:this},a,b)},b.prototype.dispatchEvent=function(a,b,c){return this._emitter.dispatchEvent.call(this._emitter)},b}()}(),Element.prototype.qq=function(b){return a.qq(b,this)},Element.prototype.q=function(b){return a.q(b,this)},Element.prototype.query=Element.prototype.q,Element.prototype.query.all=Element.prototype.qq,Element.prototype.q.all=Element.prototype.qq,Element.prototype.append=function(a){return this.appendChild(a),this},Element.prototype.prepend=function(a){return null!=this.firstChild?this.insertBefore(a,this.firstChild):this.append(a),this},Element.prototype.before=function(a){if(this.parentElement)return this.parentElement.insertBefore(a,this),this},Element.prototype.after=function(a){if(this.parentElement)return null!=this.nextSibling?this.parentElement.insertBefore(a,this.nextSibling):this.parentElement.append(a),this},Element.prototype.text=function(b){var c,d,e,f,g,h,i,j,k,l;if(null==b)return this.textContent;for(j=this.childNodes,e=0,g=j.length;e<g;e++)i=j[e],i.remove();if(b instanceof NodeList||b instanceof Array){for(c="",k=[].slice.call(b),f=0,h=k.length;f<h;f++)l=k[f],c+=l instanceof Text?l.get():"string"==typeof l?l:l.toString();return d=a.t(c),this.append(d),d}return b instanceof Text&&(b=b.get()),d=a.t(b),this.append(d),d},Element.prototype.html=function(a){var b,c,d,e,f,g,h,i;if(null==a)return this.innerHTML;for(i=this.childNodes,d=0,f=i.length;d<f;d++)h=i[d],h.remove();if(a instanceof Element)return this.append(a),this;if(a instanceof NodeList||a instanceof Array){for(b=[].slice.call(a),e=0,g=b.length;e<g;e++)c=b[e],(c instanceof Element||c instanceof Text)&&this.append(c);return this}return a instanceof Text&&(a=a.get()),this.innerHTML=a,this},Element.prototype.path=function(){var b,c,d,e;for(e=this,d=[];e.parentNode;){if(""!==e.id){d.unshift("#"+e.id);break}if(e===a.q("html"))d.unshift(e.tagName.toLowerCase());else{for(c=1,b=e;b.previousElementSibling;)b=b.previousElementSibling,c++;d.unshift(e.tagName.toLowerCase()+":nth-child("+c+")")}e=e.parentNode}return d.join(" > ")},Element.prototype.css=function(a,b){var c,d,e,f,g;if(c=function(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().slice(1)})},d=function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},"string"==typeof a){if(null==b)return this.css()[c(a)]||this.css()[d(a)];this.style[c(a)]=b}if("object"==typeof a){for(e in a)g=a[e],this.style[c(e)]=g;return this}if(null==a){a=getComputedStyle(this),f={};for(e in a)g=a[e],isNaN(+e)&&(f[e]=g)}return f},Element.prototype.attr=function(a,b){var c,d;if("object"==typeof a){for(c in a)d=a[c],this.setAttribute(c,d);return this}return null==b?this.getAttribute(a):(this.setAttribute(a,b),this)},Element.prototype.observe=function(){var a;return null==this._observer&&(this._observerHandlers=[],this._observer=new MutationObserver(function(a){return function(b){var c,d,e,f,g,h,i;for(i=a._observerHandlers,d=0,f=i.length;d<f;d++)for(c=i[d],e=0,g=b.length;e<g;e++)h=b[e],c.call(a,h);return a}}(this)),a={attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0},this._observer.observe(this,a)),this},Element.prototype.stopObserving=function(){return null!=this._observer&&(this._observer.disconnect(),delete this._observer),this},EventTarget.prototype.on=function(a,b,c){var d,e,f,g,h;for(a instanceof Array||(a=[a]),h=null!=this.emitter?this.emitter:this,d=null!=this.emitter?this.obj:this,null==h._events&&(h._events={}),null==h._eventsInited&&(h._eventsInited={}),f=0,g=a.length;f<g;f++)e=a[f],null==h._events[e]&&(h._events[e]=[]),h._events[e].push(b),h._eventsInited[e]!==!0&&h.addEventListener(e,function(a){var b,c,f,g,i;for(null!=a.waffData&&(a=a.waffData),g=h._events[e],i=[],c=0,f=g.length;c<f;c++)b=g[c],i.push(b.call(d,a));return i},c),h._eventsInited[e]=!0;return h},Element.prototype.on=function(a,b,c){var d,e,f,g;for(a instanceof Array||(a=[a]),d=EventTarget.prototype.on,f=0,g=a.length;f<g;f++)switch(e=a[f]){case"mutation":this._observerHandlers.push(b);break;default:d.apply(this,arguments)}return this},EventTarget.prototype.off=function(a,b,c){var d,e,f,g,h;for(a instanceof Array||(a=[a]),h=null!=this.emitter?this.emitter:this,null==h._events&&(h._events={}),f=0,g=a.length;f<g;f++)e=a[f],null==h._events[e]&&(h._events[e]=[]),null==b&&(h._events[e]=[]),(d=function(a){return function(a){var b;if(b=h._events[e].indexOf(a),b!==-1)return h._events[e].splice(b,1),d(a)}}(this))(b);return h},Element.prototype.off=function(a,b,c){var d,e,f,g,h;for(a instanceof Array||(a=[a]),d=EventTarget.prototype.off,g=0,h=a.length;g<h;g++)switch(e=a[g]){case"mutation":f=this._observerHandlers.indexOf(b),f!==-1&&this._observerHandlers.splice(f,1);break;default:d.apply(this,[e,b,c])}return this},EventTarget.prototype.once=function(a,b,c){var d,e,f,g,h,i;for(a instanceof Array||(a=[a]),i=null!=this.emitter?this.emitter:this,d=null!=this.emitter?this.obj:this,f=function(a){var e;return e=function(f){return b.call(d,f),i.off(a,e,c)},i.on(a,e,c)},g=0,h=a.length;g<h;g++)e=a[g],f(e);return i},EventTarget.prototype.emit=function(a,b){var c,d;return d=null!=this.emitter?this.emitter:this,c=null!=this.emitter?this.obj:this,"string"==typeof a&&(a=new Event(a)),"object"==typeof a&&b&&(a.waffData=b),a.waffThis=c,d.dispatchEvent(a)},Event.extend=function(b){var c;return c=b._emitter=a.e(),null==b.on&&(b.on=c.on.bind({emitter:c,obj:b})),null==b.once&&(b.once=c.once.bind({emitter:c,obj:b})),null==b.off&&(b.off=c.off.bind({emitter:c,obj:b})),null==b.dispatchEvent&&(b.dispatchEvent=c.dispatchEvent.bind(c)),null==b.emit&&(b.emit=c.emit.bind({emitter:c,obj:b})),b},Text.prototype.set=function(a){return this.nodeValue=a,this},Text.prototype.get=function(){return this.nodeValue,this},a}());